---
description: Comprehensive code review for quality and production-readiness
globs: ["**/*"]
alwaysApply: false
---

# Code Review

Perform a thorough code review. Be critical but constructive.

## Review Checklist

### ğŸ”’ Security
- [ ] Authentication/authorization properly checked
- [ ] User input validated and sanitized
- [ ] No secrets/credentials in code
- [ ] SQL injection / XSS prevention in place
- [ ] RLS policies configured (if using Supabase)
- [ ] Sensitive data not logged

### ğŸ› Error Handling
- [ ] Try-catch for async operations
- [ ] Errors provide useful context
- [ ] Failed states handled gracefully in UI
- [ ] No silent failures
- [ ] Proper error boundaries (React)

### ğŸ“ Code Quality
- [ ] No `console.log` statements (use proper logger)
- [ ] No `any` types in TypeScript
- [ ] No `@ts-ignore` or `@ts-expect-error`
- [ ] No TODO/FIXME left unaddressed
- [ ] No commented-out code
- [ ] No hardcoded values that should be config
- [ ] Functions are single-purpose and testable

### âš¡ Performance
- [ ] No unnecessary re-renders (React)
- [ ] Expensive calculations memoized
- [ ] Large lists virtualized
- [ ] Images optimized
- [ ] No N+1 query patterns
- [ ] Proper loading states

### ğŸ¯ Architecture
- [ ] Follows existing codebase patterns
- [ ] Code in correct directory/module
- [ ] No circular dependencies
- [ ] Separation of concerns maintained
- [ ] Reusable components extracted appropriately

### ğŸ“± UX Considerations
- [ ] Loading states present
- [ ] Error states handled visually
- [ ] Responsive design maintained
- [ ] Accessibility basics (labels, alt text, keyboard nav)
- [ ] Optimistic updates where appropriate

### ğŸ§ª Testing
- [ ] Unit tests for business logic
- [ ] Integration tests for critical paths
- [ ] Edge cases covered
- [ ] Mocks are appropriate (not over-mocked)

## Output Format

```markdown
# Code Review: [Feature/Branch Name]

**Reviewer:** Claude
**Date:** [Date]
**Files Reviewed:** [Count]

---

## âœ… What Looks Good
- [Positive observation 1]
- [Positive observation 2]
- [Positive observation 3]

---

## ğŸš¨ Critical Issues
> Must fix before merge

### Issue 1: [Title]
**Location:** `file.ts:42`
**Problem:** [Description]
**Risk:** [What could go wrong]
**Fix:**
```typescript
// suggested code
```

---

## âš ï¸ Warnings
> Should fix, but not blocking

### Warning 1: [Title]
**Location:** `file.ts:87`
**Problem:** [Description]
**Suggestion:** [How to improve]

---

## ğŸ’¡ Suggestions
> Nice to have improvements

- [Suggestion 1]
- [Suggestion 2]

---

## ğŸ“Š Summary

| Category | Status |
|----------|--------|
| Security | âœ… / âš ï¸ / ğŸš¨ |
| Error Handling | âœ… / âš ï¸ / ğŸš¨ |
| Code Quality | âœ… / âš ï¸ / ğŸš¨ |
| Performance | âœ… / âš ï¸ / ğŸš¨ |
| Architecture | âœ… / âš ï¸ / ğŸš¨ |

**Verdict:** Ready to merge / Needs fixes / Major rework needed

**Critical Issues:** [Count]
**Warnings:** [Count]
**Suggestions:** [Count]
```

## Severity Definitions

| Level | Meaning | Examples |
|-------|---------|----------|
| ğŸš¨ **Critical** | Security vulnerability, data loss risk, crashes | SQL injection, unhandled promise, missing auth |
| âš ï¸ **Warning** | Bugs, performance issues, poor UX | Missing error state, N+1 queries, no loading |
| ğŸ’¡ **Suggestion** | Code quality, maintainability | Better naming, extract function, add comment |

## Rules

- **Be specific** - Include file:line for every issue
- **Provide fixes** - Don't just complain, show the solution
- **Prioritize** - Critical issues first
- **Stay objective** - Code quality, not style preferences
- **Check git diff** - Review what actually changed, not entire files

## Starting Review

Say: "Starting code review. Specify files/branch to review, or I'll review recent changes (git diff)."
