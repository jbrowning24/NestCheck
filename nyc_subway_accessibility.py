"""NYC subway station accessibility data from MTA official dataset.

Source: MTA Subway Stations (data.ny.gov dataset 39hk-dx4f)
ADA field: 0 = not accessible, 1 = fully accessible, 2 = partially accessible

Each tuple: (lat, lng, step_free_entrance, has_elevator)
ADA=1 stations have both step-free entrance and elevators.
ADA=2 stations have partial accessibility (one direction only).
ADA=0 stations have no step-free entrance or elevators.
"""

from math import radians, cos, sqrt
from typing import Optional, Tuple


# (lat, lng, step_free_entrance, has_elevator)
_NYC_SUBWAY_STATIONS: Tuple[Tuple[float, float, bool, bool], ...] = (
    (40.775036, -73.912034, False, False),  # Astoria-Ditmars Blvd (N W)
    (40.770258, -73.917843, True, True),  # Astoria Blvd (N W)
    (40.766779, -73.921479, False, False),  # 30 Av (N W)
    (40.761820, -73.925508, False, False),  # Broadway (N W)
    (40.756804, -73.929575, False, False),  # 36 Av (N W)
    (40.752882, -73.932755, False, False),  # 39 Av-Dutch Kills (N W)
    (40.764811, -73.973347, False, False),  # 5 Av/59 St (N R W)
    (40.764664, -73.980658, True, True),  # 57 St-7 Av (N Q R W)
    (40.759901, -73.984139, True, True),  # 49 St (N R W)
    (40.745494, -73.988691, False, False),  # 28 St (R W)
    (40.741303, -73.989344, False, False),  # 23 St (R W)
    (40.730328, -73.992629, False, False),  # 8 St-NYU (R W)
    (40.724329, -73.997702, False, False),  # Prince St (R W)
    (40.713282, -74.006978, False, False),  # City Hall (R W)
    (40.707220, -74.013342, False, False),  # Rector St (R W)
    (40.690635, -73.981824, True, True),  # DeKalb Av (B Q R)
    (40.677316, -73.983110, False, False),  # Union St (R)
    (40.665414, -73.992872, False, False),  # Prospect Av (R)
    (40.660397, -73.998091, False, False),  # 25 St (R)
    (40.655144, -74.003549, False, False),  # 36 St (D N R)
    (40.648939, -74.010006, False, False),  # 45 St (R)
    (40.645069, -74.014034, False, False),  # 53 St (R)
    (40.641362, -74.017881, True, True),  # 59 St (N R)
    (40.634967, -74.023377, False, False),  # Bay Ridge Av (R)
    (40.629742, -74.025510, False, False),  # 77 St (R)
    (40.622687, -74.028398, True, True),  # 86 St (R)
    (40.616622, -74.030876, True, True),  # Bay Ridge-95 St (R)
    (40.677050, -73.972367, False, False),  # 7 Av (B Q)
    (40.661614, -73.962246, True, True),  # Prospect Park (B Q S)
    (40.655292, -73.961495, False, False),  # Parkside Av (Q)
    (40.650527, -73.962982, True, True),  # Church Av (B Q)
    (40.644031, -73.964492, False, False),  # Beverley Rd (Q)
    (40.640927, -73.963891, False, False),  # Cortelyou Rd (Q)
    (40.635082, -73.962793, False, False),  # Newkirk Plaza (B Q)
    (40.629270, -73.961639, True, True),  # Avenue H (Q)
    (40.625039, -73.960803, False, False),  # Avenue J (Q)
    (40.617618, -73.959399, False, False),  # Avenue M (Q)
    (40.608670, -73.957734, True, True),  # Kings Hwy (B Q)
    (40.599300, -73.955929, False, False),  # Avenue U (Q)
    (40.595246, -73.955161, False, False),  # Neck Rd (Q)
    (40.586896, -73.954155, True, True),  # Sheepshead Bay (B Q)
    (40.577621, -73.961376, False, False),  # Brighton Beach (B Q)
    (40.576312, -73.968501, False, False),  # Ocean Pkwy (Q)
    (40.576127, -73.975939, False, False),  # W 8 St-NY Aquarium (F Q)
    (40.577422, -73.981233, True, True),  # Coney Island-Stillwell Av (D F N Q)
    (40.646292, -73.994324, False, False),  # 9 Av (D)
    (40.640914, -73.994304, False, False),  # Fort Hamilton Pkwy (D)
    (40.636260, -73.994791, False, False),  # 50 St (D)
    (40.631435, -73.995476, False, False),  # 55 St (D)
    (40.619589, -73.998864, False, False),  # 71 St (D)
    (40.613501, -74.000610, False, False),  # 79 St (D)
    (40.607954, -74.001736, False, False),  # 18 Av (D)
    (40.604556, -73.998168, False, False),  # 20 Av (D)
    (40.601875, -73.993728, True, True),  # Bay Pkwy (D)
    (40.597704, -73.986829, False, False),  # 25 Av (D)
    (40.588841, -73.983765, False, False),  # Bay 50 St (D)
    (40.635064, -74.011719, True, True),  # 8 Av (N)
    (40.631386, -74.005351, False, False),  # Fort Hamilton Pkwy (N)
    (40.620671, -73.990414, False, False),  # 18 Av (N)
    (40.617410, -73.985026, False, False),  # 20 Av (N)
    (40.611815, -73.981848, False, False),  # Bay Pkwy (N)
    (40.603923, -73.980353, False, False),  # Kings Hwy (N)
    (40.597473, -73.979137, False, False),  # Avenue U (N)
    (40.592721, -73.978230, False, False),  # 86 St (N)
    (40.700492, -73.828294, False, False),  # 121 St (J Z)
    (40.697418, -73.836345, False, False),  # 111 St (J)
    (40.695178, -73.844330, False, False),  # 104 St (J Z)
    (40.693879, -73.851576, True, True),  # Woodhaven Blvd (J Z)
    (40.692435, -73.860010, False, False),  # 85 St-Forest Pkwy (J)
    (40.691324, -73.867139, False, False),  # 75 St-Elderts Ln (J Z)
    (40.689941, -73.872550, False, False),  # Cypress Hills (J)
    (40.683194, -73.873785, False, False),  # Crescent St (J Z)
    (40.681410, -73.880039, False, False),  # Norwood Av (J Z)
    (40.679947, -73.884639, False, False),  # Cleveland St (J)
    (40.678024, -73.891688, False, False),  # Van Siclen Av (J Z)
    (40.676992, -73.898654, False, False),  # Alabama Av (J Z)
    (40.682893, -73.910456, False, False),  # Chauncey St (J Z)
    (40.686370, -73.916559, False, False),  # Halsey St (J)
    (40.689630, -73.922270, False, False),  # Gates Av (J Z)
    (40.693342, -73.928814, False, False),  # Kosciuszko St (J)
    (40.697207, -73.935657, False, False),  # Myrtle Av (J M Z)
    (40.700260, -73.941126, True, True),  # Flushing Av (J M)
    (40.703869, -73.947408, False, False),  # Lorimer St (J M)
    (40.706870, -73.953431, False, False),  # Hewes St (J M)
    (40.708359, -73.957757, True, True),  # Marcy Av (J M Z)
    (40.720280, -73.993915, False, False),  # Bowery (J Z)
    (40.706476, -74.011056, False, False),  # Broad St (J Z)
    (40.711396, -73.889601, True, True),  # Middle Village-Metropolitan Av (M)
    (40.706186, -73.895877, False, False),  # Fresh Pond Rd (M)
    (40.704423, -73.903077, False, False),  # Forest Av (M)
    (40.702762, -73.907740, False, False),  # Seneca Av (M)
    (40.698664, -73.919711, False, False),  # Knickerbocker Av (M)
    (40.697857, -73.927397, False, False),  # Central Av (M)
    (40.732849, -73.986122, False, False),  # 3 Av (L)
    (40.730953, -73.981628, True, True),  # 1 Av (L)
    (40.717304, -73.956872, True, True),  # Bedford Av (L)
    (40.714565, -73.944053, False, False),  # Graham Av (L)
    (40.711926, -73.940670, True, True),  # Grand St (L)
    (40.707739, -73.939850, False, False),  # Montrose Av (L)
    (40.706152, -73.933147, False, False),  # Morgan Av (L)
    (40.706607, -73.922913, False, False),  # Jefferson St (L)
    (40.703811, -73.918425, False, False),  # DeKalb Av (L)
    (40.695602, -73.904084, False, False),  # Halsey St (L)
    (40.688764, -73.904046, True, True),  # Wilson Av (L)
    (40.682829, -73.905249, False, False),  # Bushwick Av-Aberdeen St (L)
    (40.675345, -73.903097, False, False),  # Atlantic Av (L)
    (40.669367, -73.901975, False, False),  # Sutter Av (L)
    (40.664038, -73.900571, True, True),  # Livonia Av (L)
    (40.658733, -73.899232, False, False),  # New Lots Av (L)
    (40.650573, -73.899485, False, False),  # East 105 St (L)
    (40.646654, -73.901850, True, True),  # Canarsie-Rockaway Pkwy (L)
    (40.674772, -73.957624, True, True),  # Park Pl (S)
    (40.868072, -73.919899, True, True),  # Inwood-207 St (A)
    (40.865491, -73.927271, False, False),  # Dyckman St (A)
    (40.859022, -73.934180, False, False),  # 190 St (A)
    (40.851695, -73.937969, True, True),  # 181 St (A)
    (40.847391, -73.939704, True, True),  # 175 St (A)
    (40.836013, -73.939892, False, False),  # 163 St-Amsterdam Av (C)
    (40.830518, -73.941514, False, False),  # 155 St (C)
    (40.824783, -73.944216, False, False),  # 145 St (A B C D)
    (40.817894, -73.947649, False, False),  # 135 St (B C)
    (40.811109, -73.952343, True, True),  # 125 St (A B C D)
    (40.805085, -73.954882, False, False),  # 116 St (B C)
    (40.800603, -73.958161, False, False),  # Cathedral Pkwy (110 St) (B C)
    (40.796092, -73.961454, False, False),  # 103 St (B C)
    (40.791642, -73.964696, False, False),  # 96 St (B C)
    (40.785868, -73.968916, False, False),  # 86 St (B C)
    (40.781433, -73.972143, False, False),  # 81 St-Museum of Natural History (B C)
    (40.775594, -73.976410, False, False),  # 72 St (B C)
    (40.762456, -73.985984, True, True),  # 50 St (C E)
    (40.752287, -73.993391, True, True),  # 34 St-Penn Station (A C E)
    (40.745906, -73.998041, False, False),  # 23 St (C E)
    (40.732338, -74.000495, True, True),  # W 4 St-Wash Sq (A B C D E F M)
    (40.726227, -74.003739, True, True),  # Spring St (C E)
    (40.720824, -74.005229, False, False),  # Canal St (A C E)
    (40.699337, -73.990531, False, False),  # High St (A C)
    (40.688484, -73.985001, False, False),  # Hoyt-Schermerhorn Sts (A C G)
    (40.686113, -73.973946, False, False),  # Lafayette Av (C)
    (40.683263, -73.965838, False, False),  # Clinton-Washington Avs (C)
    (40.680438, -73.950426, False, False),  # Nostrand Av (A C)
    (40.679921, -73.940858, False, False),  # Kingston-Throop Avs (C)
    (40.679364, -73.930729, True, True),  # Utica Av (A C)
    (40.678822, -73.920786, False, False),  # Ralph Av (C)
    (40.678340, -73.911946, False, False),  # Rockaway Av (C)
    (40.674542, -73.896548, False, False),  # Liberty Av (C)
    (40.672710, -73.890358, False, False),  # Van Siclen Av (C)
    (40.674130, -73.880750, False, False),  # Shepherd Av (C)
    (40.675377, -73.872106, True, True),  # Euclid Av (A C)
    (40.677044, -73.865050, False, False),  # Grant Av (A)
    (40.679371, -73.858992, False, False),  # 80 St (A)
    (40.679843, -73.851470, False, False),  # 88 St (A)
    (40.680429, -73.843853, False, False),  # Rockaway Blvd (A)
    (40.681711, -73.837683, False, False),  # 104 St (A)
    (40.684331, -73.832163, False, False),  # 111 St (A)
    (40.685951, -73.825798, True, True),  # Ozone Park-Lefferts Blvd (A)
    (40.672097, -73.835919, True, True),  # Aqueduct Racetrack (A)
    (40.668234, -73.834058, False, False),  # Aqueduct-N Conduit Av (A)
    (40.660476, -73.830301, True, True),  # Howard Beach-JFK Airport (A)
    (40.608382, -73.815925, False, False),  # Broad Channel (A S)
    (40.588034, -73.813641, False, False),  # Beach 90 St (A S)
    (40.585307, -73.820558, False, False),  # Beach 98 St (A S)
    (40.583209, -73.827559, False, False),  # Beach 105 St (A S)
    (40.580903, -73.835592, True, True),  # Rockaway Park-Beach 116 St (A S)
    (40.590927, -73.796924, True, True),  # Beach 67 St (A)
    (40.592374, -73.788522, False, False),  # Beach 60 St (A)
    (40.592943, -73.776013, False, False),  # Beach 44 St (A)
    (40.595398, -73.768175, False, False),  # Beach 36 St (A)
    (40.600066, -73.761353, False, False),  # Beach 25 St (A)
    (40.603995, -73.755405, True, True),  # Far Rockaway-Mott Av (A)
    (40.874811, -73.878855, False, False),  # Norwood-205 St (D)
    (40.873244, -73.887138, True, True),  # Bedford Park Blvd (B D)
    (40.866978, -73.893509, True, True),  # Kingsbridge Rd (B D)
    (40.861296, -73.897749, False, False),  # Fordham Rd (B D)
    (40.856093, -73.900741, False, False),  # 182-183 Sts (B D)
    (40.850410, -73.905227, True, True),  # Tremont Av (B D)
    (40.845900, -73.910136, False, False),  # 174-175 Sts (B D)
    (40.839306, -73.913400, False, False),  # 170 St (B D)
    (40.833771, -73.918440, False, False),  # 167 St (B D)
    (40.830135, -73.938209, False, False),  # 155 St (B D)
    (40.754203, -73.942836, True, True),  # 21 St-Queensbridge (M)
    (40.759145, -73.953260, True, True),  # Roosevelt Island (M)
    (40.764629, -73.966113, True, True),  # Lexington Av/63 St (M Q)
    (40.763972, -73.977450, False, False),  # 57 St (M)
    (40.758663, -73.981329, True, True),  # 47-50 Sts-Rockefeller Ctr (B D F M)
    (40.742878, -73.992821, False, False),  # 23 St (F M)
    (40.718267, -73.993753, False, False),  # Grand St (B D)
    (40.723402, -73.989938, False, False),  # 2 Av (F)
    (40.713715, -73.990173, False, False),  # East Broadway (F)
    (40.701397, -73.986751, False, False),  # York St (F)
    (40.686145, -73.990862, False, False),  # Bergen St (F G)
    (40.680303, -73.995048, False, False),  # Carroll St (F G)
    (40.673580, -73.995959, False, False),  # Smith-9 Sts (F G)
    (40.666271, -73.980305, True, True),  # 7 Av (F G)
    (40.660365, -73.979493, False, False),  # 15 St-Prospect Park (F G)
    (40.650782, -73.975776, False, False),  # Fort Hamilton Pkwy (F G)
    (40.644041, -73.979678, True, True),  # Church Av (F G)
    (40.636119, -73.978172, False, False),  # Ditmas Av (F)
    (40.629755, -73.976971, False, False),  # 18 Av (F)
    (40.625322, -73.976127, False, False),  # Avenue I (F)
    (40.620769, -73.975264, False, False),  # Bay Pkwy (F)
    (40.615140, -73.974197, False, False),  # Avenue N (F)
    (40.608944, -73.973022, False, False),  # Avenue P (F)
    (40.603217, -73.972361, False, False),  # Kings Hwy (F)
    (40.596063, -73.973357, False, False),  # Avenue U (F)
    (40.589620, -73.974250, False, False),  # Avenue X (F)
    (40.581011, -73.974574, False, False),  # Neptune Av (F)
    (40.712646, -73.783817, True, True),  # Jamaica-179 St (F)
    (40.710470, -73.793604, False, False),  # 169 St (F)
    (40.707564, -73.803326, False, False),  # Parsons Blvd (F)
    (40.705460, -73.810708, False, False),  # Sutphin Blvd (F)
    (40.709179, -73.820574, False, False),  # Briarwood (E F)
    (40.714441, -73.831008, True, True),  # Kew Gardens-Union Tpke (E F)
    (40.718331, -73.837324, False, False),  # 75 Av (E F)
    (40.721691, -73.844521, True, True),  # Forest Hills-71 Av (E F M R)
    (40.726523, -73.852719, False, False),  # 67 Av (M R)
    (40.729846, -73.861604, False, False),  # 63 Dr-Rego Park (M R)
    (40.733106, -73.869229, False, False),  # Woodhaven Blvd (M R)
    (40.737015, -73.877223, False, False),  # Grand Av-Newtown (M R)
    (40.742454, -73.882017, False, False),  # Elmhurst Av (M R)
    (40.749669, -73.898453, False, False),  # 65 St (M R)
    (40.752885, -73.906006, True, True),  # Northern Blvd (M R)
    (40.756312, -73.913333, False, False),  # 46 St (M R)
    (40.756879, -73.920740, False, False),  # Steinway St (M R)
    (40.752039, -73.928781, False, False),  # 36 St (M R)
    (40.748973, -73.937243, True, True),  # Queens Plaza (E F R)
    (40.760167, -73.975224, False, False),  # 5 Av/53 St (E F)
    (40.762862, -73.981637, False, False),  # 7 Av (B D E)
    (40.702147, -73.801109, True, True),  # Jamaica Center-Parsons/Archer (E J Z)
    (40.700486, -73.807969, True, True),  # Sutphin Blvd-Archer Av-JFK Airport (E J Z)
    (40.702566, -73.816859, True, True),  # Jamaica-Van Wyck (E)
    (40.744065, -73.949724, False, False),  # 21 St (G)
    (40.731352, -73.954449, True, True),  # Greenpoint Av (G)
    (40.724635, -73.951277, False, False),  # Nassau Av (G)
    (40.706092, -73.950308, False, False),  # Broadway (G)
    (40.700377, -73.950234, False, False),  # Flushing Av (G)
    (40.694568, -73.949046, False, False),  # Myrtle-Willoughby Avs (G)
    (40.689627, -73.953522, False, False),  # Bedford-Nostrand Avs (G)
    (40.688873, -73.960070, False, False),  # Classon Av (G)
    (40.688089, -73.966839, False, False),  # Clinton-Washington Avs (G)
    (40.687119, -73.975375, False, False),  # Fulton St (G)
    (40.889248, -73.898583, False, False),  # Van Cortlandt Park-242 St (1)
    (40.884667, -73.900870, False, False),  # 238 St (1)
    (40.878856, -73.904834, True, True),  # 231 St (1)
    (40.874561, -73.909831, False, False),  # Marble Hill-225 St (1)
    (40.869444, -73.915279, False, False),  # 215 St (1)
    (40.864621, -73.918822, False, False),  # 207 St (1)
    (40.860531, -73.925536, True, True),  # Dyckman St (1)
    (40.855225, -73.929412, False, False),  # 191 St (1)
    (40.849505, -73.933596, False, False),  # 181 St (1)
    (40.834041, -73.944890, False, False),  # 157 St (1)
    (40.826551, -73.950360, False, False),  # 145 St (1)
    (40.822008, -73.953676, False, False),  # 137 St-City College (1)
    (40.815581, -73.958372, False, False),  # 125 St (1)
    (40.807722, -73.964110, False, False),  # 116 St-Columbia University (1)
    (40.803967, -73.966847, False, False),  # Cathedral Pkwy (110 St) (1)
    (40.799446, -73.968379, False, False),  # 103 St (1)
    (40.793919, -73.972323, True, True),  # 96 St (1 2 3)
    (40.788644, -73.976218, False, False),  # 86 St (1)
    (40.783934, -73.979917, False, False),  # 79 St (1)
    (40.778453, -73.981970, True, True),  # 72 St (1 2 3)
    (40.773440, -73.982209, True, True),  # 66 St-Lincoln Center (1)
    (40.761728, -73.983849, False, False),  # 50 St (1)
    (40.750373, -73.991057, True, True),  # 34 St-Penn Station (1 2 3)
    (40.747215, -73.993365, False, False),  # 28 St (1)
    (40.744081, -73.995657, False, False),  # 23 St (1)
    (40.741040, -73.997871, False, False),  # 18 St (1)
    (40.733422, -74.002906, False, False),  # Christopher St-Stonewall (1)
    (40.728251, -74.005367, False, False),  # Houston St (1)
    (40.722854, -74.006277, False, False),  # Canal St (1)
    (40.719318, -74.006886, False, False),  # Franklin St (1)
    (40.715478, -74.009266, True, True),  # Chambers St (1 2 3)
    (40.711835, -74.012188, True, True),  # WTC Cortlandt (1)
    (40.707513, -74.013783, False, False),  # Rector St (1)
    (40.706821, -74.009100, False, False),  # Wall St (2 3)
    (40.697466, -73.993086, False, False),  # Clark St (2 3)
    (40.690545, -73.985065, True, True),  # Hoyt St (2 3)
    (40.688246, -73.980492, False, False),  # Nevins St (2 3 4 5)
    (40.680829, -73.975098, False, False),  # Bergen St (2 3)
    (40.675235, -73.971046, False, False),  # Grand Army Plaza (2 3)
    (40.671987, -73.964375, True, True),  # Eastern Pkwy-Brooklyn Museum (2 3)
    (40.669847, -73.950466, False, False),  # Nostrand Av (3)
    (40.669399, -73.942161, False, False),  # Kingston Av (3)
    (40.668897, -73.932942, True, True),  # Crown Hts-Utica Av (3 4)
    (40.664717, -73.922610, False, False),  # Sutter Av-Rutland Rd (3)
    (40.661453, -73.916327, False, False),  # Saratoga Av (3)
    (40.662549, -73.908946, False, False),  # Rockaway Av (3)
    (40.663515, -73.902447, False, False),  # Junius St (3)
    (40.664635, -73.894895, False, False),  # Pennsylvania Av (3)
    (40.665449, -73.889395, False, False),  # Van Siclen Av (3)
    (40.666235, -73.884079, False, False),  # New Lots Av (3)
    (40.667883, -73.950683, False, False),  # President St-Medgar Evers College (2 5)
    (40.662742, -73.950850, False, False),  # Sterling St (2 5)
    (40.656652, -73.950200, False, False),  # Winthrop St (2 5)
    (40.650843, -73.949575, True, True),  # Church Av (2 5)
    (40.645098, -73.948959, False, False),  # Beverly Rd (2 5)
    (40.639967, -73.948411, False, False),  # Newkirk Av-Little Haiti (2 5)
    (40.632836, -73.947642, True, True),  # Flatbush Av-Brooklyn College (2 5)
    (40.852462, -73.828121, True, True),  # Pelham Bay Park (6)
    (40.846810, -73.832569, False, False),  # Buhre Av (6)
    (40.843863, -73.836322, False, False),  # Middletown Rd (6)
    (40.839892, -73.842952, True, True),  # Westchester Sq-E Tremont Av (6)
    (40.836488, -73.847036, False, False),  # Zerega Av (6)
    (40.834255, -73.851222, False, False),  # Castle Hill Av (6)
    (40.833226, -73.860816, True, True),  # Parkchester (6)
    (40.831509, -73.867618, False, False),  # St Lawrence Av (6)
    (40.829521, -73.874516, False, False),  # Morrison Av-Soundview (6)
    (40.828584, -73.879159, False, False),  # Elder Av (6)
    (40.826525, -73.886283, False, False),  # Whitlock Av (6)
    (40.820948, -73.890549, True, True),  # Hunts Point Av (6)
    (40.816104, -73.896435, False, False),  # Longwood Av (6)
    (40.812118, -73.904098, True, True),  # E 149 St (6)
    (40.808719, -73.907657, False, False),  # E 143 St-St Mary's St (6)
    (40.805368, -73.914042, False, False),  # Cypress Av (6)
    (40.807566, -73.919240, False, False),  # Brook Av (6)
    (40.810476, -73.926138, False, False),  # 3 Av-138 St (6)
    (40.886037, -73.878751, False, False),  # Woodlawn (4)
    (40.879750, -73.884655, True, True),  # Mosholu Pkwy (4)
    (40.873412, -73.890064, False, False),  # Bedford Park Blvd-Lehman College (4)
    (40.867760, -73.897174, False, False),  # Kingsbridge Rd (4)
    (40.862803, -73.901034, True, True),  # Fordham Rd (4)
    (40.858407, -73.903879, False, False),  # 183 St (4)
    (40.853453, -73.907684, False, False),  # Burnside Av (4)
    (40.848480, -73.911794, False, False),  # 176 St (4)
    (40.844434, -73.914685, False, False),  # Mt Eden Av (4)
    (40.840075, -73.917791, True, True),  # 170 St (4)
    (40.835537, -73.921400, False, False),  # 167 St (4)
    (40.813224, -73.929849, False, False),  # 138 St-Grand Concourse (4 5)
    (40.804138, -73.937594, True, True),  # 125 St (4 5 6)
    (40.798629, -73.941617, False, False),  # 116 St (6)
    (40.795020, -73.944250, False, False),  # 110 St (6)
    (40.790600, -73.947478, False, False),  # 103 St (6)
    (40.785672, -73.951070, False, False),  # 96 St (6)
    (40.779492, -73.955589, True, True),  # 86 St (4 5 6)
    (40.773620, -73.959874, False, False),  # 77 St (6)
    (40.768141, -73.963870, True, True),  # 68 St-Hunter College (6)
    (40.746081, -73.982076, False, False),  # 33 St (6)
    (40.743070, -73.984264, True, True),  # 28 St (6)
    (40.739864, -73.986599, True, True),  # 23 St-Baruch College (6)
    (40.730054, -73.991070, False, False),  # Astor Pl (6)
    (40.722301, -73.997141, False, False),  # Spring St (6)
    (40.707557, -74.011862, False, False),  # Wall St (4 5)
    (40.704817, -74.014065, True, True),  # Bowling Green (4 5)
    (40.903125, -73.850620, False, False),  # Wakefield-241 St (2)
    (40.898379, -73.854376, False, False),  # Nereid Av (2 5)
    (40.893193, -73.857473, True, True),  # 233 St (2 5)
    (40.888022, -73.860341, False, False),  # 225 St (2 5)
    (40.883895, -73.862633, False, False),  # 219 St (2 5)
    (40.877850, -73.866256, True, True),  # Gun Hill Rd (2 5)
    (40.871356, -73.867164, False, False),  # Burke Av (2 5)
    (40.865462, -73.867352, False, False),  # Allerton Av (2 5)
    (40.857192, -73.867615, True, True),  # Pelham Pkwy (2 5)
    (40.848828, -73.868457, False, False),  # Bronx Park East (2 5)
    (40.841894, -73.873488, True, True),  # E 180 St (2 5)
    (40.840295, -73.880049, False, False),  # West Farms Sq-E Tremont Av (2 5)
    (40.837288, -73.887734, False, False),  # 174 St (2 5)
    (40.829993, -73.891865, False, False),  # Freeman St (2 5)
    (40.824073, -73.893064, True, True),  # Simpson St (2 5)
    (40.822181, -73.896736, False, False),  # Intervale Av (2 5)
    (40.819585, -73.901770, False, False),  # Prospect Av (2 5)
    (40.816490, -73.907807, False, False),  # Jackson Av (2 5)
    (40.816109, -73.917757, True, True),  # 3 Av-149 St (2 5)
    (40.823880, -73.936470, False, False),  # Harlem-148 St (3)
    (40.820421, -73.936245, False, False),  # 145 St (3)
    (40.814229, -73.940770, True, True),  # 135 St (2 3)
    (40.807754, -73.945495, False, False),  # 125 St (2 3)
    (40.802098, -73.949625, False, False),  # 116 St (2 3)
    (40.799075, -73.951822, False, False),  # 110 St-Malcolm X Plaza (2 3)
    (40.888300, -73.830834, False, False),  # Eastchester-Dyre Av (5)
    (40.878663, -73.838591, False, False),  # Baychester Av (5)
    (40.869526, -73.846384, True, True),  # Gun Hill Rd (5)
    (40.858985, -73.855359, False, False),  # Pelham Pkwy (5)
    (40.854364, -73.860495, False, False),  # Morris Park (5)
    (40.759600, -73.830030, True, True),  # Flushing-Main St (7)
    (40.754622, -73.845625, False, False),  # Mets-Willets Point (7)
    (40.751730, -73.855334, False, False),  # 111 St (7)
    (40.749865, -73.862700, False, False),  # 103 St-Corona Plaza (7)
    (40.749145, -73.869527, True, True),  # Junction Blvd (7)
    (40.748408, -73.876613, False, False),  # 90 St-Elmhurst Av (7)
    (40.747659, -73.883697, False, False),  # 82 St-Jackson Hts (7)
    (40.746325, -73.896403, False, False),  # 69 St (7)
    (40.745630, -73.902984, True, True),  # 61 St-Woodside (7)
    (40.744149, -73.912549, False, False),  # 52 St (7)
    (40.743132, -73.918435, False, False),  # 46 St-Bliss St (7)
    (40.743781, -73.924016, False, False),  # 40 St-Lowery St (7)
    (40.744587, -73.930997, False, False),  # 33 St-Rawson St (7)
    (40.750582, -73.940202, True, True),  # Queensboro Plaza (7 N W)
    (40.742216, -73.948916, False, False),  # Hunters Point Av (7)
    (40.742626, -73.953581, False, False),  # Vernon Blvd-Jackson Av (7)
    (40.755882, -74.001910, True, True),  # 34 St-Hudson Yards (7)
    (40.784318, -73.947152, True, True),  # 96 St (Q)
    (40.777891, -73.951787, True, True),  # 86 St (Q)
    (40.768799, -73.958424, True, True),  # 72 St (Q)
    (40.643748, -74.073643, True, True),  # St George (SIR)
    (40.636949, -74.074835, False, False),  # Tompkinsville (SIR)
    (40.627915, -74.075162, False, False),  # Stapleton (SIR)
    (40.621319, -74.071402, False, False),  # Clifton (SIR)
    (40.603117, -74.084087, False, False),  # Grasmere (SIR)
    (40.596612, -74.087368, False, False),  # Old Town (SIR)
    (40.588849, -74.096090, True, True),  # Dongan Hills (SIR)
    (40.583591, -74.103338, False, False),  # Jefferson Av (SIR)
    (40.578965, -74.109704, False, False),  # Grant City (SIR)
    (40.573480, -74.117210, True, True),  # New Dorp (SIR)
    (40.565110, -74.126320, False, False),  # Oakwood Heights (SIR)
    (40.556400, -74.136907, False, False),  # Bay Terrace (SIR)
    (40.551231, -74.151399, True, True),  # Great Kills (SIR)
    (40.544601, -74.164570, False, False),  # Eltingville (SIR)
    (40.540460, -74.178217, False, False),  # Annadale (SIR)
    (40.533674, -74.191794, False, False),  # Huguenot (SIR)
    (40.525507, -74.200064, False, False),  # Prince's Bay (SIR)
    (40.522410, -74.217847, False, False),  # Pleasant Plains (SIR)
    (40.519631, -74.229141, False, False),  # Richmond Valley (SIR)
    (40.512764, -74.251961, True, True),  # Tottenville (SIR)
    (40.516578, -74.242096, True, True),  # Arthur Kill (SIR)
    (40.737796, -73.997732, True, True),  # 14 St/6 Av (1 2 3 F L M)
    (40.735066, -73.990416, True, True),  # 14 St-Union Sq (4 5 6 L N Q R W)
    (40.818393, -73.927034, False, False),  # 149 St-Grand Concourse (2 4 5)
    (40.827950, -73.925741, True, True),  # 161 St-Yankee Stadium (4 B D)
    (40.840637, -73.939847, True, True),  # 168 St/168 St-Washington Hts (1 A C)
    (40.747141, -73.945032, True, True),  # Court Sq/Court Sq-23 St (7 E F G)
    (40.749643, -73.987887, True, True),  # 34 St-Herald Sq (B D F M N Q R W)
    (40.670559, -73.989041, False, False),  # 4 Av-9 St (F G R)
    (40.754022, -73.983266, False, False),  # 42 St-Bryant Pk/5 Av (7 B D F M)
    (40.751992, -73.977359, True, True),  # Grand Central-42 St (4 5 6 7 S)
    (40.755746, -73.987581, True, True),  # 42 St-Port Authority Bus Terminal/Times Sq-42 St (1 2 3 7 A C E N Q R S W)
    (40.757329, -73.970487, True, True),  # 51 St/Lexington Av/53 St (6 E F)
    (40.762593, -73.967613, False, False),  # 59 St/Lexington Av/59 St (4 5 6 N R W)
    (40.768271, -73.981832, True, True),  # 59 St-Columbus Circle (1 A B C D)
    (40.625657, -73.996624, True, True),  # 62 St/New Utrecht Av (D N)
    (40.746746, -73.891366, True, True),  # 74 St-Broadway/Jackson Hts-Roosevelt Av (7 E F M R)
    (40.684162, -73.977789, True, True),  # Atlantic Av-Barclays Ctr (2 3 4 5 B D N Q R)
    (40.740335, -74.002134, True, True),  # 14 St/8 Av (A C E L)
    (40.725606, -73.995431, True, True),  # Bleecker St/Broadway-Lafayette St (6 B D F M)
    (40.693241, -73.990642, True, True),  # Borough Hall/Court St (2 3 4 5 R)
    (40.678896, -73.904356, False, False),  # Broadway Junction (A C J L Z)
    (40.713154, -74.003766, True, True),  # Brooklyn Bridge-City Hall/Chambers St (4 5 6 J Z)
    (40.718701, -74.000580, True, True),  # Canal St (6 J N Q R W Z)
    (40.712603, -74.009552, True, True),  # Chambers St/Cortlandt St/Park Place/World Trade Center (2 3 A C E R W)
    (40.718463, -73.987775, False, False),  # Delancey St-Essex St (F J M Z)
    (40.670513, -73.958688, False, False),  # Botanic Garden/Franklin Av-Medgar Evers College (2 3 4 5 S)
    (40.680988, -73.956337, True, True),  # Franklin Av (C S)
    (40.710089, -74.007838, True, True),  # Fulton St (2 3 4 5 A C J Z)
    (40.713428, -73.950847, True, True),  # Lorimer St/Metropolitan Av (G L)
    (40.699622, -73.911986, True, True),  # Myrtle-Wyckoff Avs (L M)
    (40.702577, -74.013329, True, True),  # South Ferry/Whitehall St-South Ferry (1 R W)
    (40.692259, -73.986642, True, True),  # Jay St-MetroTech (A C F R)
)


# Maximum distance in meters to match a station
_MATCH_RADIUS_M = 300


def _approx_distance_m(lat1: float, lng1: float, lat2: float, lng2: float) -> float:
    """Fast approximate distance in meters using equirectangular projection."""
    dlat = radians(lat2 - lat1)
    dlng = radians(lng2 - lng1) * cos(radians((lat1 + lat2) / 2))
    return sqrt(dlat * dlat + dlng * dlng) * 6_371_000


def lookup_nyc_subway_accessibility(
    lat: float, lng: float
) -> Optional[Tuple[bool, bool]]:
    """Look up accessibility for the nearest NYC subway station.

    Returns (step_free_entrance, has_elevator) if a station is found
    within 300 m, or None if no match.
    """
    best_dist = _MATCH_RADIUS_M
    best_result: Optional[Tuple[bool, bool]] = None
    for slat, slng, step_free, elevator in _NYC_SUBWAY_STATIONS:
        d = _approx_distance_m(lat, lng, slat, slng)
        if d < best_dist:
            best_dist = d
            best_result = (step_free, elevator)
    return best_result
